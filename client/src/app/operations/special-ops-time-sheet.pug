login-toolbar(toolbar-title='operations.title')

side-bar

.page-content-wrapper.time-sheet(ng-class="{'page-content-left' : noneStyle}")
	.container-fluid-flex
		md-toolbar.form-root-toolbar
			.md-toolbar-tools.form-toolbar-glarus
				md-truncate
					span.title-breadcrum
						| {{ 'operations.title' | translate }}
					h2.title-bar-txt
						| {{ 'operations.specialsTimeLog.title' | translate }}

				//- md-truncate.filter-label
				//- 	| {{ 'operations.specialsTimeLog.filterLabel' | translate }}

				md-truncate.add-form.filter-label
					md-input-container
						label
							| {{ 'operations.specialsTimeLog.filterLabel' | translate }}
						md-select(aria-label='option' ng-model='periodFilterKey' ng-change='periodChange()')
							md-option(ng-value='option.key', ng-repeat='option in periodFilterOptions') {{ option.label | translate }}
				span(flex)

				md-button.arrow.md-icon-button(aria-label="Upload" ng-click='export()')
					md-icon.fa.fa-download.fa-lg

		.add-row-section
			md-truncate.add-form-container
				form(name='driverTimeSheet').add-form
					.element
						md-autocomplete(md-no-cache='false',
						md-items="item in staffSearch(lbSearch.staff) | orderBy:'resource.name.last'",
						md-selected-item='lbRow.staff',
						md-search-text='lbSearch.staff',
						md-selected-item-change='staffSelectedItemChange(item)',
						md-item-text='item.resource.name.last+" "+item.resource.name.first',
						md-min-length='0',
						md-floating-label="{{ 'operations.specialsTimeLog.staff' | translate }}")
							md-item-template
								span(md-highlight-text='lbSearch.staff', md-highlight-flags='^i') {{item.resource.name.last+', '+item.resource.name.first}}

					.vertical-line

					.element-small
						md-autocomplete(md-no-cache='false',
						md-items='item in opsSearch(lbSearch.operation) | orderBy : ["-start"]',
						md-selected-item='lbRow.operation',
						md-search-text-change='opsSearchTextChange(lbSearch.operation)',
						md-search-text='lbSearch.operation',
						md-selected-item-change='opsSelectedItemChange(item)',
						md-item-text='item.name',
						md-min-length='0',
						md-floating-label="{{ 'operations.specialsTimeLog.operation' | translate }}")
							md-item-template
								span(md-highlight-text='lbSearch.operation', md-highlight-flags='^i') {{item.name}}

					.vertical-line

					.element
						md-input-container.jnx-datetime-picker
							label {{ 'operations.specialsTimeLog.begin' | translate }}
							input(mdc-datetime-picker=''
							date='true'
							time='true'
							show-todays-date=''
							minutes='true'
							format='YYYY-MM-DD HH:mm'
							edit-input='true'
							click-outside-to-close='true'
							show-icon='true'
							minute-steps='1'
							ng-model='lbRow.start'
							ng-model-options="{ debounce: 1000 }"
							type='text' required='',
							lang='{{ lang }}',
							today-text='{{ "label.today" | translate }}',
							ok-text='{{ "label.ok" | translate }}',
							cancel-text='{{ "label.cancel" | translate }}')

					.vertical-line

					.element
						md-input-container.jnx-datetime-picker
							label {{ 'operations.specialsTimeLog.end' | translate }}
							input(mdc-datetime-picker=''
							date='true'
							time='true'
							show-todays-date=''
							minutes='true'
							min-date='lbRow.start'
							format='YYYY-MM-DD HH:mm'
							edit-input='true'
							click-outside-to-close='true'
							show-icon='true'
							minute-steps='1'
							ng-model='lbRow.end'
							ng-model-options="{ debounce: 1000 }"
							type='text',
							lang='{{ lang }}',
							today-text='{{ "label.today" | translate }}',
							ok-text='{{ "label.ok" | translate }}',
							cancel-text='{{ "label.cancel" | translate }}')

					.vertical-line

					.element
						md-input-container
							label {{ 'operations.specialsTimeLog.comment' | translate }}
							input(ng-model='lbRow.location')

					.vertical-line

					.element
						md-autocomplete(md-no-cache='false',
						md-items="item in vehicleSearch(lbSearch.vehicle) | orderBy:'name'",
						md-selected-item='lbRow.vehicle',
						md-search-text='lbSearch.vehicle',
						md-item-text='item.resource.name + " " + item.resource.plateNumber',
						md-min-length='0',
						md-floating-label="{{ 'operations.specialsTimeLog.vehicle' | translate }}")
							md-item-template
								p() {{item.resource.name}} #[br] {{ item.resource.plateNumber}}

					.element-small
						md-input-container
							label {{ 'operations.specialsTimeLog.odometerStart' | translate }}
							input(ng-model='lbRow.odometerStart' type="number")

					.element-small
						md-input-container
							label {{ 'operations.specialsTimeLog.odometerEnd' | translate }}
							input(ng-model='lbRow.odometerEnd' type="number")

					.element-very-small
						md-input-container
							label {{ 'operations.specialsTimeLog.fuelStart' | translate }}
							md-select(ng-model='lbRow.fuelStart')
								md-option(value="F") F
								md-option(value="7/8") 7/8
								md-option(value="3/4") 3/4
								md-option(value="5/8") 5/8
								md-option(value="4/8") 1/2
								md-option(value="3/8") 3/8
								md-option(value="2/8") 1/4
								md-option(value="1/8") 1/8

					.element-very-small
						md-input-container
							label {{ 'operations.specialsTimeLog.fuelEnd' | translate }}
							md-select(ng-model='lbRow.fuelEnd')
								md-option(value="F") F
								md-option(value="7/8") 7/8
								md-option(value="3/4") 3/4
								md-option(value="5/8") 5/8
								md-option(value="4/8") 1/2
								md-option(value="3/8") 3/8
								md-option(value="2/8") 1/4
								md-option(value="1/8") 1/8

					.btn-element-small

						md-button.md-icon-button.stack(aria-label="Grid" ng-click='addRow()')
							md-icon.fa.fa-plus-square.fa-lg

		.container-body(style="margin-top:-20px; padding-bottom:50px;")
			.driver-time-sheet.ag-fresh(ag-grid="gridOptions" ag-grid-reload="agGridSizeToFit")
footer-Janux